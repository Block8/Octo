<div class="row">
    <div class="col-xs-12 col-sm-7 col-md-7 col-lg-4">
        <h1 class="page-title txt-color-blueDark"><i class="fa fa-fw fa-home "></i> My Dashboard</h1>
    </div>

    <div class="col-xs-12 col-sm-5 col-md-5 col-lg-8 hidden-xs">
        <ul id="sparks" class="">
            {if (can_access uri: "/form")}
            {if forms}
            <li class="sparks-info">
                <h5> Contacts <span class="txt-color-blue"><i class="fa fa-user"></i>&nbsp;{@contacts}</span></h5>
            </li>

            <li class="sparks-info">
                <h5> Submissions <span class="txt-color-purple"><i class="fa fa-envelope"></i>&nbsp;{@submissions}</span></h5>
            </li>
            {/if}
            {/if}

            {if pages}
            <li class="sparks-info">
                <h5> Total Pages <span class="txt-color-greenDark"><i class="fa fa-sitemap"></i>&nbsp;{@pages}</span></h5>
            </li>
            {/if}
        </ul>
    </div>
</div>

{if showAnalytics}
<div class="row">

    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
        <div class="jarviswidget jarviswidget-sortable" id="wid-id-0" data-widget-togglebutton="false" data-widget-editbutton="false" data-widget-fullscreenbutton="false" data-widget-colorbutton="false" data-widget-deletebutton="false" role="widget" style="">

        <header role="heading">
            <span class="widget-icon"> <i class="glyphicon glyphicon-stats txt-color-darken"></i> </span>
            <h2>Statistics</h2>

            <ul class="nav nav-tabs pull-right in" id="analytics">
                <li class="active">
                    <a data-toggle="tab" href="#pageviews">Pageviews</a>
                </li>
                <li>
                    <a data-toggle="tab" href="#uniquePageviews">Unique Pageviews</a>
                </li>
                <li>
                    <a data-toggle="tab" href="#visitors">Visitors</a>
                </li>
            </ul>

            <span class="jarviswidget-loader"><i class="fa fa-refresh fa-spin"></i></span></header>

            <div class="no-padding" role="content" id="analytics_container">

                {include template: "Dashboard/analytics"; variables: "pageviews" => metric }
                {include template: "Dashboard/analytics"; variables: "uniquePageviews" => metric }
                {include template: "Dashboard/analytics"; variables: "visitors" => metric, 1 => responsive }

            </div>

        </div>

    </div>

</div>
{/if}

<div class="row">
    
    {if forms}
    {if (can_access uri: "/form")}
    <div class="col-lg-6">
        <div class="jarviswidget jarviswidget-color-blueDark " data-widget-editbutton="false" data-widget-custombutton="false" role="widget" style="">
            <header role="heading">
                <h2>Latest Form Submissions</h2>
            </header>

            <div role="content">
                <div class="widget-body no-padding">
                    <table class="table table-bordered table-striped">
                        <thead>
                        <tr>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Date</th>
                            <th width="20%">Actions</th>
                        </tr>
                        </thead>
                        <tbody>
                        {for latestSubmissions}
                        <tr>
                            <td>{@value.Contact.first_name} {@value.Contact.last_name}</td>
                            <td>{@value.Contact.email}</td>
                            <td>{@value.created_date.formatted}</td>
                            <td>
                                {if (can_access uri: "/form/submission")}
                                <a class="btn btn-default btn-sm" href="/{@adminUri}/form/submission/{@value.id}">View</a>
                                {/if}
                            </td>
                        </tr>
                        {/for}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    {/if}
    {/if}
    
    {if showSpider}
    <div class="col-lg-12">
        <div class="jarviswidget jarviswidget-color-blueDark " data-widget-editbutton="false" data-widget-custombutton="false" role="widget" style="">
            <header role="heading">
                <h2><i class="fa fa-fw fa-bug "></i> Dead Link Spider</h2>
            </header>

            <div role="content">
                <div class="widget-body no-padding">
                    <table class="table table-bordered table-striped" width="100%">
                        <thead>
                        <tr>
                            <th>URL</th>
                            <th>Linked From</th>
                            <th>Status</th>
                        </tr>
                        </thead>
                        <tbody>
                        {for deadLinks}
                        <tr>
                            <td width="40%" style="overflow:hidden;text-overflow:ellipsis;">{@value.url}</td>
                            <td width="40%" style="overflow:hidden;text-overflow:ellipsis;">{@value.parent_url}</td>
                            <td width="10%" style="overflow:hidden;text-overflow:ellipsis;">{@value.http_response_code}</td>
                        </tr>
                        {/for}
                        </tbody>
                    </table>
					<div class="bar-holder">
						<div style="text-align:right;margin-top:1em;"><a class="btn btn-default" href="javascript:void(0);">Scan Now</a></div>
					</div>               
                </div>
            </div>
        </div>
    </div>
    {/if}
    
    
    {if pages}
    <div class="col-lg-6">
        <div class="jarviswidget jarviswidget-color-blueDark " data-widget-editbutton="false" data-widget-custombutton="false" role="widget" style="">
            <header role="heading">
                <h2>Recently Edited Pages</h2>
            </header>

            <div role="content">
                <div class="widget-body no-padding">
                    <table class="table table-bordered table-striped">
                        <thead>
                        <tr>
                            <th>Title</th>
                            <th>Last Editor</th>
                            <th>Last Update</th>
                        </tr>
                        </thead>
                        <tbody>
                        {for latestPages}
                        <tr>
                            <td>
                                {if (can_access uri: "/page/edit")}
                                <a href="/{@adminUri}/page/edit/{@item.id}">{@item.CurrentVersion.title}</a>
                                {/if}
                                {ifnot (can_access uri: "/page/edit")}{@item.CurrentVersion.title}{/ifnot}
                            </td>
                            <td>{if item.CurrentVersion.User}{@item.CurrentVersion.User.name}{/if}</td>
                            <td>{date_format date: item.CurrentVersion.updated_date}</td>
                        </tr>
                        {/for}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    {/if}
    
</div>
