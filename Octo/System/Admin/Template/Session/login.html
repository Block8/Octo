<!DOCTYPE html>
<html style="background-color: #444;">
<head>
    <meta charset="UTF-8">
    <title>Sign in to {@config.site.name}</title>
    <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'>

    <link href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.2/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" type="text/css" href="{@config.site.url}/asset/css/System/AdminLTE">

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

    <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js"></script>

    <![endif]-->
    {if settings.google-identity_login_enabled}
    <script src="https://apis.google.com/js/client:platform.js" async defer></script>
    <meta name="google-signin-client_id" content="{@settings.google-identity_client_id}">
    {/if}
</head>
<body class="login-page" style="background-color: #444;">

<div class="login-box">
    <div class="login-box-body">
        <p class="login-box-msg">Sign in to {@config.site.name}</p>
        {if GlobalMessage:error}
        <div class="alert alert-danger fade in">
            <strong>Error:</strong> {@GlobalMessage:error}
        </div>
        {/if}

        {if GlobalMessage:success}
        <div class="alert alert-success fade in">
            {@GlobalMessage:success}
        </div>
        {/if}

        {if GlobalMessage:info}
        <div class="alert alert-info fade in">
            {@GlobalMessage:info}
        </div>
        {/if}

        {if errorMessage}
        <div class="alert alert-danger fade in" style="margin-top: -20px;">
            <i class="fa-fw fa fa-times"></i>
            <strong>Error:</strong> {@errorMessage}
        </div>
        {/if}

        <form action="{@adminUri}/session/login" method="POST">
            <div class="form-group has-feedback">
                <input id="email" name="email" type="email" class="form-control" placeholder="Enter your Email Address"/>
                <span class="glyphicon glyphicon-envelope form-control-feedback"></span>
            </div>
            <div class="form-group has-feedback">
                <input id="password" name="password" type="password" class="form-control" placeholder="Enter your Password"/>
                <span class="glyphicon glyphicon-lock form-control-feedback"></span>
            </div>
            <div class="row">
                <div class="col-xs-4 col-xs-offset-8">
                    <button type="submit" class="btn btn-primary btn-block btn-flat">Sign In</button>
                </div><!-- /.col -->
            </div>
        </form>

        {if settings.google-identity_login_enabled}
        <div class="social-auth-links text-center">
            <p>- OR -</p>

            <div style="text-align: center;">
                <form id="gi-auth" action="{@adminUri}/google-identity/auth" method="POST">
                    <input type="hidden" name="email" id="gi-email">
                    <input type="hidden" name="token" id="gi-token">
                </form>

            </div>

            <div class="g-signin2" data-onsuccess="onSignIn"></div>
        </div><!-- /.social-auth-links -->
        {/if}

        <p><a href="{@adminUri}/session/forgot-password">I forgot my password</a></p>
    </div><!-- /.login-box-body -->
</div><!-- /.login-box -->

{if settings.google-identity_login_enabled}
<script>
    {if GET.logout}
    var logout = true;
    {/if}

    {ifnot GET.logout}
    var logout = false;
    {/ifnot}


    function onSignIn(googleUser) {
        if (logout) {
            logout = false;
            gapi.auth2.getAuthInstance().signOut();
            return;
        }

        var profile = googleUser.getBasicProfile();

        $('#gi-email').val(profile.getEmail());
        $('#gi-token').val(googleUser.getAuthResponse().id_token);
        $('#gi-auth').submit();
    }
</script>
{/if}
</body>
</html>